#!/bin/bash

# For Ubuntu OS


APT=$(apt list --installed 2> /dev/null  | grep -ow '\w*debsecan\w*')

if [ $APT = debsecan ] ;
    then 
        echo " Debsecan is already  present "
else
    apt install debsecan -y
fi


DEB=$(debsecan | awk '/remotely exploitable/ { vuln[$2]++ } END { for (package in vuln) print package }' | sort)
ip4=$(/sbin/ip -o -4 addr list eth0 | awk '{print $4}' | cut -d/ -f1)

if [ ! -n "$DEB" ] ; 
    then
        echo "No Problem"
        #curl -X POST --silent --data-urlencode "payload={\"text\": \"@abhishek @prashanth @aslamraza No vulnerable package found in $(echo $ip4) server.\"}" https://chat.bangalore2.com/hooks/5ub7wxdz5jy1jyzzqqx443p6pc
else
    curl -X POST --silent --data-urlencode "payload={\"text\": \"@abhishek @prashanth @aslamraza Vulnerable package found in server $(echo $ip4) please take action.\"}" https://chat.bangalore2.com/hooks/5ub7wxdz5jy1jyzzqqx443p6pc #change the api url

fi