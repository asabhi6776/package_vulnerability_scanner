#!/bin/bash

# For Ubuntu OS


APT=$(apt list 2> /dev/null  | grep -ow '\w*debsecan\w*')

if [ $APT = debsecan ] ;
    then 
        echo " Debsecan is already  present "
else
    apt install debsecan -y
fi


DEB=$(debsecan | awk '/remotely exploitable/ { vuln[$2]++ } END { for (package in vuln) print package }' | sort)

if [ ! -n "$DEB" ] ; 
    then
        curl -X POST -H 'Content-type: application/json' --data '{"text":"@abhishek No vulnerable package found in all the Debian based servers"}' https://chat.bangalore2.com/hooks/5ub7wxdz5jy1jyzzqqx443p6pc
else
    curl -X POST -H 'Content-type: application/json' --data '{"text":"@abhishek One are more vulnerable package found please take action"}' https://chat.bangalore2.com/hooks/5ub7wxdz5jy1jyzzqqx443p6pc

fi